{
  "description" : "sysmon",
  "processors" : [
    { "set":           { "field": "event.code", "value": "{{winlog.event_id}}", "override": true }  },     
    { "set":           { "field": "event.module", "value": "sysmon", "override": true }  },   
    { "set":           { "if": "ctx.winlog?.computer_name != null",   "field": "observer.name", "value": "{{winlog.computer_name}}", "override": true }  },
    { "set":           { "if": "ctx.event?.code == '3'",   "field": "event.category", "value": "host,process,network", "override": true }  },
    { "set":           { "if": "ctx.event?.code == '1'",   "field": "event.category", "value": "host,process", "override": true }  },
    { "set":           { "if": "ctx.event?.code == '5'",   "field": "event.category", "value": "host,process", "override": true }  },
    { "set":           { "if": "ctx.event?.code == '6'",   "field": "event.category", "value": "host,driver", "override": true }  },
    { "set":           { "if": "ctx.event?.code == '22'",   "field": "event.category", "value": "network", "override": true }  },
    { "set":          { "if": "ctx.event?.code == '1'",   "field": "event.dataset", "value": "process_creation", "override": true }  },
    { "set":          { "if": "ctx.event?.code == '3'",   "field": "event.dataset", "value": "network_connection", "override": true }  },
    { "set":          { "if": "ctx.event?.code == '4'",   "field": "event.dataset", "value": "sysmon_service_status", "override": true }  },
    { "set":          { "if": "ctx.event?.code == '5'",   "field": "event.dataset", "value": "process_terminated", "override": true }  },
    { "set":          { "if": "ctx.event?.code == '9'",   "field": "event.dataset", "value": "raw_file_access_read", "override": true }  },
    { "set":          { "if": "ctx.event?.code == '11'",   "field": "event.dataset", "value": "file_create", "override": true }  },
    { "set":          { "if": "ctx.event?.code == '16'",   "field": "event.dataset", "value": "config_change", "override": true }  },
    { "set":          { "if": "ctx.event?.code == '23'",   "field": "event.dataset", "value": "file_delete", "override": true }  },
    { "rename":       { "field": "winlog.event_data.CommandLine", "target_field": "process.command_line",  "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.CurrentDirectory", "target_field": "process.working_directory",  "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.Image", "target_field": "process.executable",  "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.ParentCommandLine", "target_field": "process.parent.command_line",  "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.ParentImage", "target_field": "process.parent.executable",  "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.ParentProcessId", "target_field": "process.ppid",  "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.ParentUser", "target_field": "parent.user.name",  "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.ProcessId", "target_field": "process.pid",  "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.User", "target_field": "user.name",  "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.OriginalFileName", "target_field": "process.pe.original_file_name", "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.DestinationIp", "target_field": "destination.ip",  "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.DestinationPort", "target_field": "destination.port",  "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.SourceIp", "target_field": "source.ip",  "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.SourcePort", "target_field": "source.port",  "ignore_missing": true  } },   
    { "rename":       { "field": "winlog.event_data.Protocol", "target_field": "network.transport", "ignore_missing": true  } },
    { "rename":       { "field": "winlog.event_data.TargetFilename", "target_field": "file.target", "ignore_missing": true  } },
    { "community_id": {} }
  ]
}
